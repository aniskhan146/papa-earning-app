<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>PAPA TAP Game</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css"/>
    <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="//libtl.com/sdk.js" data-zone="9678845" data-sdk="show_9678845"></script>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style> body{font-family:'Poppins',sans-serif;overflow:hidden} .page{display:none;height:100%;flex-direction:column} .page.active{display:flex} .tap-circle.tapped{transform:scale(.95)} .floating-number{position:absolute;font-size:2.5rem;font-weight:800;color:#fff;opacity:1;transition:all 1s ease-out;pointer-events:none;text-shadow:0 2px 4px #00000080} </style>
</head>
<body class="bg-gradient-to-b from-yellow-400 via-orange-500 to-red-600 text-white select-none">
<div id="app-container" class="flex flex-col h-screen max-w-md mx-auto bg-black/40 backdrop-blur-sm">
<main class="flex-grow overflow-hidden">
    <!-- EARN, TASK, PROFILE PAGES (Unchanged) -->
    <div id="earnPage" class="page active p-4 space-y-4">...</div>
    <div id="taskPage" class="page p-4 overflow-y-auto">...</div>
    <div id="profilePage" class="page p-4 items-center justify-center">...</div>
    
    <!-- ADS PAGE (‡¶®‡¶§‡ßÅ‡¶® ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶® ‡¶∏‡¶π) -->
    <div id="adsPage" class="page p-4 overflow-y-auto">
        <h1 class="text-3xl font-bold text-center mb-6">Ads For USDT</h1>
        <p class="text-sm text-center text-gray-400 mb-6">Watch an ad to claim your reward. There is a short cooldown after each watch.</p>
        <div id="adTaskList" class="space-y-3"></div>
        <p id="adTaskMessage" class="text-center mt-4 text-yellow-400 h-6"></p>
        <button type="button" class="mt-8 text-gray-300 underline" onclick="showPage('earnPage')">Go Back</button>
    </div>
</main>
<!-- ‡¶®‡ßá‡¶≠‡¶ø‡¶ó‡ßá‡¶∂‡¶® (‡¶Ü‡¶á‡¶ï‡¶® ‡¶∏‡¶π) -->
<footer class="bg-black/30 p-2 z-10"><div class="swiper bottom-nav-slider"><div class="swiper-wrapper" id="navWrapper"></div></div><style>.nav-item{display:flex;flex-direction:column;align-items:center;justify-content:center;color:#9ca3af;padding:4px 0;cursor:pointer;transition:all .3s;width:25%!important}.nav-item.active,.nav-item:hover{color:#fff;transform:scale(1.1)}.nav-item span{font-size:.7rem;font-weight:500}</style></footer>
</div>

<script>
    const SERVER_URL = 'https://papa-earning-app.onrender.com';
    let gameState = {};
    let tgUser = {};
    let adCooldownInterval;
    const AD_COOLDOWN = 25; // frontend-‡¶è‡¶ì ‡¶∏‡¶Æ‡ßü‡¶ü‡¶æ ‡¶∞‡¶æ‡¶ñ‡¶æ ‡¶π‡¶≤‡ßã ‡¶ü‡¶æ‡¶á‡¶Æ‡¶æ‡¶∞ ‡¶¶‡ßá‡¶ñ‡¶æ‡¶®‡ßã‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø

    const TASKS_DATA = {"task1":{"coins":50000,"usdt":.1,"title":"Join Community"},"task2":{"coins":100000,"usdt":0,"title":"Follow on X"}};
    
    // Ads ‡¶ü‡¶æ‡¶∏‡ßç‡¶ï‡ßá‡¶∞ ‡¶™‡ßÅ‡¶∞‡¶∏‡ßç‡¶ï‡¶æ‡¶∞ ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶®
    const ADS_TASKS = [
        { id: "monetag_reward_1", title: "Monetag Rewarded Ad 1", icon: "üì∫", reward: "+0.00000551 USDT", status: "active"},
        { id: "monetag_reward_2", title: "Monetag Rewarded Ad 2", icon: "‚ú®", reward: "+0.00000551 USDT", status: "active"},
        { id: "partner_ad_1", title: "New Partner Offer", icon: "ü§ù", reward: "SOON", status: "coming_soon"},
        { id: "video_ad_1", title: "Watch Short Video", icon: "üé¨", reward: "SOON", status: "coming_soon"},
        { id: "special_promo", title: "Special Promo Ad", icon: "üíé", reward: "SOON", status: "coming_soon"}
    ];
    
    // --- ‡¶®‡¶§‡ßÅ‡¶®: ‡¶Ü‡¶á‡¶ï‡¶®‡¶∏‡¶π ‡¶®‡ßá‡¶≠‡¶ø‡¶ó‡ßá‡¶∂‡¶® ‡¶Ü‡¶á‡¶ü‡ßá‡¶Æ ---
    const navItemsConfig = [
        {id:"earnPage",label:"Earn",icon:`<svg class="w-7 h-7"fill="none"stroke="currentColor"stroke-width="1.5"viewBox="0 0 24 24"><path d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v.01"></path><path d="M12 18.5A6.5 6.5 0 1012 5.5a6.5 6.5 0 000 13z"></path></svg>`},
        {id:"adsPage",label:"Ads",icon:`<svg class="w-7 h-7"fill="none"stroke="currentColor"stroke-width="1.5"viewBox="0 0 24 24"><path d="M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"></path><path d="M15.91 11.672a.375.375 0 0 1 0 .656l-5.603 3.235a.375.375 0 0 1-.541-.328V8.765a.375.375 0 0 1 .541-.328l5.603 3.235Z"></path></svg>`},
        {id:"taskPage",label:"Task",icon:`<svg class="w-7 h-7"fill="none"stroke="currentColor"stroke-width="1.5"viewBox="0 0 24 24"><path d="M11.35 3.836A8.995 8.995 0 0 1 12 3c5.523 0 10 2.239 10 5s-4.477 5-10 5-10-2.239-10-5c0-1.294.613-2.484 1.583-3.327"></path><path d="M12 21a2 2 0 0 1-2-2v-6m4 8a2 2 0 0 0-2-2v-6m0 0a2 2 0 1 0-4 0v6a2 2 0 0 0 2 2m4 0a2 2 0 0 1 2-2v-6m0 0a2 2 0 1 1-4 0v6a2 2 0 0 1 2 2m-8-2.923A8.963 8.963 0 0 1 2.417 11.75 8.963 8.963 0 0 1 2 11c0-2.203 2.898-4.148 7-4.836"></path></svg>`},
        {id:"profilePage",label:"Profile",icon:`<svg class="w-7 h-7"fill="none"stroke="currentColor"stroke-width="1.5"viewBox="0 0 24 24"><path d="M15.75 6a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0ZM4.501 20.118a7.5 7.5 0 0 1 14.998 0A17.933 17.933 0 0 1 12 21.75a17.933 17.933 0 0 1-7.499-1.632Z"></path></svg>`}
    ];

    function renderAdsTasks() {
        const adListEl=document.getElementById("adTaskList");adListEl.innerHTML=ADS_TASKS.map(t=>`<div class="bg-gray-800 p-4 rounded-lg flex justify-between items-center"><div class="flex items-center space-x-4"><span class="text-3xl">${t.icon}</span><div><h3 class="font-bold">${t.title}</h3><p class="text-sm text-yellow-400">${t.reward}</p></div></div><button type="button" data-task-id="${t.id}" class="ad-watch-btn font-bold py-2 px-5 rounded-lg ${"active"===t.status?"bg-blue-600 hover:bg-blue-700":"bg-gray-500 cursor-not-allowed"}" ${"active"!==t.status?"disabled":""}>${"active"===t.status?"Go":"Soon"}</button></div>`).join(""),document.querySelectorAll(".ad-watch-btn").forEach(t=>t.addEventListener("click",handleAdTaskClick))
    }
    
    async function handleAdTaskClick(e) {
        const t=e.target,a=t.dataset.taskId,s=document.getElementById("adTaskMessage");if(!a||t.disabled)return;s.textContent="Loading ad...";const d=document.querySelectorAll(".ad-watch-btn:not([disabled])");d.forEach(e=>e.disabled=!0),show_9678845().then(()=>{s.textContent="Ad watched! Claiming reward...",claimAdReward(a,t)}).catch(()=>{s.textContent="Ad skipped. No reward.",d.forEach(e=>e.disabled=!1)})
    }
    
    async function claimAdReward(e,t){const a=document.getElementById("adTaskMessage");try{const s=await fetch(`${SERVER_URL}/api/reward_ad`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:tgUser.id||"default_user",adId:e})}),d=await s.json();s.ok?(a.textContent=d.message,gameState.balance=d.new_balance,gameState.last_ad_reward_time=d.last_ad_reward_time,updateAllUI(),startAdCooldown(AD_COOLDOWN)):(a.textContent=d.error,document.querySelectorAll(".ad-watch-btn:not([disabled])").forEach(e=>e.disabled=!1))}catch(e){a.textContent="Server Error.",document.querySelectorAll(".ad-watch-btn:not([disabled])").forEach(e=>e.disabled=!1)}}

    function startAdCooldown(e) {
        clearInterval(adCooldownInterval); let t=Math.ceil(e); const a=document.getElementById("adTaskMessage"),s=document.querySelectorAll('.ad-watch-btn[data-task-id^="monetag"]');
        s.forEach(e=>e.disabled=!0),adCooldownInterval=setInterval(()=>{t>0?(a.textContent=`Next ad available in ${t}s`,t--):(clearInterval(adCooldownInterval),a.textContent="You can watch an ad now!",s.forEach(e=>e.disabled=!1))},1e3)
    }
    
    window.addEventListener('load', async () => {
        // ... (‡¶Ü‡¶ó‡ßá‡¶∞ ‡¶Æ‡¶§‡ßã‡¶á ‡¶Ö‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶ø‡¶§)
        // Cooldown ‡¶ö‡ßá‡¶ï ‡¶ï‡¶∞‡¶æ ‡¶π‡¶¨‡ßá ‡¶è‡¶ñ‡¶æ‡¶®‡ßá
        const now = Date.now() / 1000;
        const timeSinceLastAd = now - (gameState.last_ad_reward_time || 0);
        if (timeSinceLastAd < AD_COOLDOWN) {
            startAdCooldown(AD_COOLDOWN - timeSinceLastAd);
        }
    });

    // (‡¶¨‡¶æ‡¶ï‡¶ø ‡¶∏‡¶¨ ‡¶ú‡¶æ‡¶≠‡¶æ‡¶∏‡ßç‡¶ï‡ßç‡¶∞‡¶ø‡¶™‡ßç‡¶ü ‡¶´‡¶æ‡¶Ç‡¶∂‡¶® ‡¶Ü‡¶ó‡ßá‡¶∞ ‡¶Æ‡¶§‡ßã‡¶á ‡¶Ö‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶ø‡¶§ ‡¶•‡¶æ‡¶ï‡¶¨‡ßá)
</script>
</body>
</html>